(this["webpackJsonpinteractive-art-t2"]=this["webpackJsonpinteractive-art-t2"]||[]).push([[0],{375:function(t,e,n){},408:function(t,e){},409:function(t,e){},417:function(t,e){},420:function(t,e){},421:function(t,e){},432:function(t,e,n){"use strict";n.r(e);var i=n(16),r=n(176),c=n.n(r),o=(n(375),n(2)),a=n(51),s=n(438),u=(n(436),n(437),n(177)),j=n(42),l=n(35),b=n(314),f=n(34);function O(t){var e=Object(a.g)(),n=e.camera,r=e.gl.domElement,c=Object(i.useRef)({});return Object(a.e)((function(){return c.current.update()})),Object(f.jsx)("orbitControls",Object(l.a)(Object(l.a)({},t),{},{ref:c,args:[n,r]}))}Object(a.d)({OrbitControls:b.a});var d=n(8),g=n.n(d),h=n(14),p=n(23),x=n(6),m=(n(371),n(75)),v=n(1),y=n(317),k=n.n(y),P=function t(){Object(v.a)(this,t)};P.instance=null,P.init=function(){P.instance=k()("https://interactive-art-t2-server.herokuapp.com",{forceNew:!0,timeout:5e3,transports:["websocket"]})},P.disconnect=function(){var t;return null===(t=P.instance)||void 0===t?void 0:t.close()};function w(t){var e=t.d,n=t.t,r=t.children,c=Object(i.useRef)(),o=Object(m.useSpring)({from:{springXZ:-1},to:{springXZ:1},loop:{reverse:!0},config:{duration:n/3*2}}).springXZ,s=Object(m.useSpring)({from:{springY:-1},to:{springY:1},loop:{reverse:!0},config:{duration:n}}).springY;return Object(a.e)((function(){c.current.position.z=Math.cos(o.get())*e/2,c.current.position.x=Math.sin(o.get())*e/2,c.current.position.y=Math.sin(s.get())*e})),Object(f.jsx)(m.a.group,{ref:c,children:r})}var S=function(){return Object(f.jsx)(E,{x:Math.floor(100*Math.random()),y:Math.floor(30*Math.random()),z:Math.floor(100*Math.random()-50),url:"/lantern.glb"})};function C(){var t=Object(i.useState)([S(),S(),S()]),e=Object(x.a)(t,2),n=e[0],r=e[1],c=Object(i.useCallback)((function(){r((function(t){return[].concat(Object(p.a)(t),[S()])}))}),[]);return I(),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("pointLight",{position:[0,-10,0],intensity:1.5}),Object(f.jsx)(z,{}),Object(f.jsxs)(i.Suspense,{fallback:Object(f.jsx)(f.Fragment,{}),children:[Object(f.jsx)(w,{t:3e3,d:.1,children:n}),Object(f.jsx)("pointLight",{position:[0,-4,10],intensity:1.5}),Object(i.useMemo)((function(){return Object(f.jsx)(F,{addLenterns:c,x:-4,y:-2,z:52})}),[c])]})]})}function L(){return Object(f.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",zIndex:100},children:Object(f.jsxs)(a.a,{translate:!0,onCreated:function(t){return t.gl.setClearColor(16777215,0)},colorManagement:!0,shadowMap:!0,camera:{position:[0,0,60],fov:60},children:[Object(f.jsx)(C,{}),Object(f.jsx)(O,{}),Object(f.jsx)("gridHelper",{})]})})}function M(t){return 1-Math.cos(t*Math.PI/2)}function A(t){return Math.sin(t*Math.PI/2)}function R(t){return-(Math.cos(Math.PI*t)-1)/2}function F(t){var e=t.addLenterns,n=t.x,r=t.y,c=t.z,s=Object(i.useState)(!1),u=Object(x.a)(s,2),j=u[0],l=u[1],b=Object(i.useState)(0),O=Object(x.a)(b,2),d=O[0],p=O[1],v=Object(i.useRef)(),y=Object(i.useRef)([]),k=Object(m.useSpringRef)(),w=Object(m.useSpring)((function(){return{lenternPosition1:[0,0,0],cameraPosition1:[0,0],ref:k}})),S=Object(x.a)(w,2),C=S[0],L=C.lenternPosition1,F=C.cameraPosition1,T=S[1],I=Object(m.useSpringRef)(),z=Object(m.useSpring)((function(){return{lenternPosition2:[0,0,0],cameraPosition2:[0,0],cameraLookAt2:[0],ref:I}})),H=Object(x.a)(z,2),W=H[0],Z=W.lenternPosition2,D=W.cameraPosition2,B=W.cameraLookAt2,U=H[1],X=Object(m.useSpringRef)(),Y=Object(m.useSpring)((function(){return{lenternPosition3:[0,0,0],cameraPosition3:[0,0],cameraLookAt3:[0],ref:X}})),_=Object(x.a)(Y,2),J=_[0],q=J.lenternPosition3,G=J.cameraPosition3,N=J.cameraLookAt3,V=_[1],K=Object(m.useSpringRef)(),Q=Object(m.useSpring)((function(){return{cameraPosition4:[0,0],cameraLookAt4:[0],ref:K}})),$=Object(x.a)(Q,2),tt=$[0],et=tt.cameraPosition4,nt=tt.cameraLookAt4,it=$[1],rt=Object(m.useSpringRef)(),ct=Object(m.useSpring)((function(){return{lenternPosition5:[0,0,0],ref:rt}})),ot=Object(x.a)(ct,2),at=ot[0].lenternPosition5,st=ot[1],ut=Object(m.useSpringRef)(),jt=Object(m.useSpring)((function(){return{lenternPosition6:[0,0,0],ref:ut}})),lt=Object(x.a)(jt,2),bt=lt[0].lenternPosition6,ft=lt[1];Object(a.e)((function(t){var e=L.get(),n=Object(x.a)(e,3),i=n[0],r=n[1],c=n[2],a=Z.get(),s=Object(x.a)(a,3),u=s[0],j=s[1],l=s[2],b=q.get(),f=Object(x.a)(b,3),O=f[0],d=f[1],g=f[2],h=at.get(),p=Object(x.a)(h,3),m=p[0],y=p[1],k=p[2],P=bt.get(),w=Object(x.a)(P,3),S=w[0],C=w[1],M=w[2],A=F.get(),R=Object(x.a)(A,2),E=R[0],T=R[1],I=D.get(),z=Object(x.a)(I,2),H=z[0],W=z[1],U=G.get(),X=Object(x.a)(U,2),Y=X[0],_=X[1],J=et.get(),V=Object(x.a)(J,2),K=V[0],Q=V[1],$=B.get(),tt=Object(x.a)($,1)[0],it=N.get(),rt=Object(x.a)(it,1)[0],ct=nt.get(),ot=Object(x.a)(ct,1)[0],st=E+H+Y+K,ut=T+W+_+Q;t.camera.lookAt(new o.Vector3(st,ut+tt+rt+ot,0)),t.camera.position.x=st,t.camera.position.y=ut,v.current.position.x=i+u+O+m+S,v.current.position.y=r+j+d+y+C,v.current.position.z=c+l+g+k+M}));var Ot=Object(i.useCallback)(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:T((function(){return{lenternPosition1:[0,0,0],cameraPosition1:[0,0,0],config:{duration:1}}})),U({lenternPosition2:[0,0,0],cameraPosition2:[0,0,0],cameraLookAt2:[0,0,0],config:{duration:1}}),V({lenternPosition3:[0,0,0],cameraPosition3:[0,0,0],cameraLookAt3:[0,0,0],config:{duration:1}}),it({cameraPosition4:[0,0,0],cameraLookAt4:[0,0,0],config:{duration:1}}),st({lenternPosition5:[0,0,0],config:{duration:1}}),ft({lenternPosition6:[0,0,0],config:{duration:1}}),e(),l(!1),p(0);case 9:case"end":return t.stop()}}),t)}))),[e,T,U,V,it,st,ft]),dt=Object(i.useCallback)(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:T((function(){return{lenternPosition1:[30,27,-5],cameraPosition1:[20,23,0],config:{duration:7e3,easing:M}}})),y.current[0]=setTimeout((function(){U({lenternPosition2:[15,12,-15],cameraPosition2:[2,5,0],cameraLookAt2:[0,3,0],config:{duration:5e3}})}),7e3),y.current[1]=setTimeout((function(){V({lenternPosition3:[19,14,-20],cameraPosition3:[0,0,0],cameraLookAt3:[0,2,0],config:{duration:5e3,easing:A}})}),12e3),y.current[2]=setTimeout((function(){it({cameraPosition4:[-22,-28,0],cameraLookAt4:[0,-5,0],config:{duration:7e3,easing:R}})}),19e3),y.current[3]=setTimeout((function(){st({lenternPosition5:[-64,-58,30],config:{duration:1}})}),22e3),y.current[4]=setTimeout((function(){ft({lenternPosition6:[0,5,10],config:{duration:5e3,easing:R}})}),24e3),y.current[5]=setTimeout((function(){Ot()}),3e4);case 7:case"end":return t.stop()}}),t)}))),[Ot,T,U,V,it,st,ft]),gt=Object(i.useCallback)((function(){console.log("onClick",j),j||(console.log("!!!animationStart!!!"),dt(),l(!0))}),[dt,j]);return Object(i.useEffect)((function(){var t,e;console.log("useEffect",P.instance),null===(t=P.instance)||void 0===t||t.on("upIntensity",(function(){console.log("upIntensity"),p((function(t){return t+1}))})),null===(e=P.instance)||void 0===e||e.on("animationStart",(function(){console.log("animationStart"),gt()}))}),[gt]),Object(i.useEffect)((function(){return function(){y.current.map((function(t){return t&&t.current()}))}}),[]),Object(f.jsxs)("mesh",{ref:v,onClick:gt,children:[Object(f.jsx)("pointLight",{distance:10,position:[n,r+5,c+9],intensity:d}),Object(f.jsx)("pointLight",{position:[n,r-2.5,c+3],intensity:.6}),Object(i.useMemo)((function(){return Object(f.jsx)(E,{x:n,y:r,z:c,url:"/lantern.glb"})}),[n,r,c])]})}function E(t){var e=t.x,n=t.y,r=t.z,c=t.url,o=Object(s.a)("/interactive-art-t2"+c).scene,a=Object(i.useMemo)((function(){return o.clone()}),[o]);return console.log(a),a?Object(f.jsx)("group",{position:[e,n,r],scale:.005,children:Object(f.jsx)("primitive",{object:a})}):null}var T=["lf","rt","up","dn","ft","bk"].map((function(t){return"/interactive-art-t2/Skybox/nightsky_"+t+".png"})),I=function(){var t=Object(a.g)().scene;return Object(i.useEffect)((function(){var e=(new o.CubeTextureLoader).load(T);t.background=e,t.environment=e}),[t]),null};function z(){return Object(f.jsxs)(u.b,{children:[Object(f.jsx)(u.a,{intensity:1,blurPass:void 0,width:j.y.AUTO_SIZE,height:j.y.AUTO_SIZE,kernelSize:j.r.LARGE,luminanceThreshold:0,luminanceSmoothing:.025}),Object(f.jsx)(u.c,{opacity:.02}),Object(f.jsx)(u.e,{eskil:!1,offset:.1})]})}function H(){return I(),null}n(233),n(232),n(431);var W=n(369);var Z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,440)).then((function(e){var n=e.getCLS,i=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),i(t),r(t),c(t),o(t)}))},D=n(439),B=n(117),U=Object(B.a)({basename:"/interactive-art-t2"});P.init(),c.a.render(Object(f.jsx)(D.b,{history:U,children:Object(f.jsxs)(D.c,{children:[Object(f.jsx)(D.a,{exact:!0,path:"/",component:function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(L,{}),Object(f.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%"},children:Object(f.jsxs)(a.a,{translate:!0,colorManagement:!0,shadowMap:!0,camera:{position:[-5,3,6],fov:60},children:[Object(f.jsx)(H,{}),Object(f.jsx)(O,{}),Object(f.jsx)("gridHelper",{})]})})]})}}),Object(f.jsx)(D.a,{exact:!0,path:"/main",component:L}),Object(f.jsx)(D.a,{exact:!0,path:"/camera",component:function(){var t=Object(i.useState)(null),e=Object(x.a)(t,2),n=e[0],r=e[1],c=Object(i.useRef)(null),o=Object(i.useState)(!1),a=Object(x.a)(o,2),s=a[0],u=a[1],j=Object(i.useState)({x:300,y:300,width:50,height:50}),b=Object(x.a)(j,2),O=b[0],d=b[1],p=Object(i.useRef)(null),m=Object(i.useRef)(null),v=Object(i.useCallback)((function(){navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then((function(t){p.current.srcObject=t,p.current.onloadedmetadata=function(){p.current.play()}}))}),[]),y=Object(i.useCallback)((function(t){var e=m.current.getContext("2d");m.current.width=p.current.videoWidth,m.current.height=p.current.videoHeight,e.clearRect(0,0,e.canvas.width,e.canvas.height);var n="16px sans-serif";e.font=n,e.textBaseline="top",e.drawImage(p.current,0,0,p.current.videoWidth,p.current.videoHeight);var i=!1;e.strokeStyle="green",e.lineWidth=3,e.strokeRect(O.x,O.y,O.width,O.height),t.forEach((function(t){var r=t.bbox[0],c=t.bbox[1],o=t.bbox[2],a=t.bbox[3];e.strokeStyle="#00FFFF",e.lineWidth=2,e.strokeRect(r,c,o,a),e.fillStyle="#00FFFF";var s=e.measureText(t.class).width,u=parseInt(n,10);(e.fillRect(r,c,s+4,u+4),"person"===t.class)&&(w({x:r,y:c,width:o,height:a},O)&&(i=!0))})),u(i),t.forEach((function(t){var n=t.bbox[0],i=t.bbox[1];e.fillStyle="#000000",e.fillText(t.class,n,i)}))}),[O]),k=Object(i.useCallback)((function(t,e){e.detect(t).then((function(n){y(n),c.current&&cancelAnimationFrame(c.current),c.current=requestAnimationFrame((function(){k(t,e)}))}))}),[y]),w=function(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y};return Object(i.useEffect)((function(){P.instance&&P.instance.emit("animationStart")}),[s]),Object(i.useEffect)((function(){n&&k(p.current,n)}),[n,k]),Object(i.useEffect)((function(){v()}),[v]),Object(f.jsxs)("div",{style:{width:window.innerWidth,height:window.innerHeight,textAlign:"center",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#333"},children:[Object(f.jsxs)("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.3)"},children:[Object(f.jsx)("h1",{style:{color:"#fff"},children:"\uc0ac\ub78c \uc778\uc2dd"}),Object(f.jsx)("p",{style:{color:"#fff"},children:"\ucd08\ub85d \ubc94\uc704\uc5d0 \uc0ac\ub78c\uc774 \ub4e4\uc5b4\uc624\uba74 \uc54c \uc218 \uc788\uc74c!"})]}),Object(f.jsx)("video",{style:{display:"none"},onLoadedData:Object(h.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W.load({});case 2:e=t.sent,r(e);case 4:case"end":return t.stop()}}),t)}))),ref:function(t){return p.current=t}}),Object(f.jsx)("canvas",{style:{border:s?"5px solid red":"5px solid #fff"},ref:function(t){return m.current=t}}),Object(f.jsxs)("div",{style:{color:"#fff",marginLeft:"16px"},children:[Object(f.jsxs)("div",{children:["x :",Object(f.jsx)("input",{type:"number",onChange:function(t){return d((function(e){return Object(l.a)(Object(l.a)({},e),{},{x:t.target.value})}))},value:O.x})]}),Object(f.jsxs)("div",{children:["y :",Object(f.jsx)("input",{type:"number",onChange:function(t){return d((function(e){return Object(l.a)(Object(l.a)({},e),{},{y:t.target.value})}))},value:O.y})]}),Object(f.jsxs)("div",{children:["w :",Object(f.jsx)("input",{type:"number",onChange:function(t){return d((function(e){return Object(l.a)(Object(l.a)({},e),{},{width:t.target.value})}))},value:O.width})]}),Object(f.jsxs)("div",{children:["h :",Object(f.jsx)("input",{type:"number",onChange:function(t){return d((function(e){return Object(l.a)(Object(l.a)({},e),{},{height:t.target.value})}))},value:O.height})]})]})]})}})]})}),document.getElementById("root")),Z()}},[[432,1,2]]]);
//# sourceMappingURL=main.8d985fc4.chunk.js.map